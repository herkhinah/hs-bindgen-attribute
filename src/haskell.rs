use std::fmt::format;

pub(crate) struct Signature {
    pub(crate) fn_name: String,
}

pub(crate) fn template(module: &str, signatures: &[Signature]) -> String {
    let names = signatures
        .iter()
        .map(|x| x.fn_name.clone())
        .collect::<Vec<String>>()
        .join(" ");
    let imports = signatures
        .iter()
        .map(|x| {
            let fn_name = &x.fn_name;
            let hs_fn = fn_name.to_string();
            let c_fn = format!("c_{fn_name}");
            format!("foreign import ccall unsafe \"{c_fn}\" {hs_fn} :: IO ()")
        })
        .collect::<Vec<String>>()
        .join("\n");
    format!(
        "-- This file was generated by `hs-bindgen` crate and contain C FFI bindings
-- wrappers for every Rust function annotated with `#[hs_bindgen]`
{{-# LANGUAGE ForeignFunctionInterface #-}}

module {module} ({names}) where

{imports}"
    )
}
